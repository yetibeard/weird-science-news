---
import SEO from "../components/SEO.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
import "../styles/base.css";

const postImports = import.meta.glob("../content/*.md", { eager: true });

const posts = Object.entries(postImports)
  .map(([path, mod]) => {
    const slug = path.split("/").pop().replace(".md", "");
    return {
      ...mod.frontmatter,
      slug,
    };
  })
  .sort((a, b) => new Date(b.date) - new Date(a.date)); // newest first

// Create structured data for the website
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  name: "Weird Science News",
  description:
    "Explore fascinating and unusual discoveries from the world of science",
  url: import.meta.env.SITE || "https://weird-science-news.com",
  publisher: {
    "@type": "Organization",
    name: "Weird Science News",
    logo: {
      "@type": "ImageObject",
      url: "/images/logo.png",
    },
  },
};
---

<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <SEO />
    <link rel="stylesheet" href="/styles/global.css" />
    <script
      type="application/ld+json"
      set:html={JSON.stringify(structuredData)}
    />
  </head>
  <body class="theme-transition">
    <ThemeToggle />
    <main class="max-w-3xl mx-auto p-6">
      <h1 class="text-5xl font-bold mb-6 text-gray-900 dark:text-gray-100">
        ðŸ§ª Weird Science News
      </h1>
      <ul class="space-y-4">
        {
          posts.map((post) => (
            <li class="group">
              <a
                href={`/posts/${post.slug}`}
                class="text-xl text-blue-600 dark:text-blue-400 hover:underline block"
              >
                {post.title}
              </a>
              <p class="text-gray-600 dark:text-gray-400">{post.summary}</p>
              <div class="text-sm text-gray-500 dark:text-gray-500">
                {new Date(post.date).toLocaleDateString()}
              </div>
            </li>
          ))
        }
      </ul>
    </main>
  </body>
</html>
